<div class="modal-background" data-bind="click: toggleImageUpload"></div>
<div class="uploadmodal">
    <div class="tabs">
    	<!-- ko if: isAuthenticated -->
    	<div class="tab tab-upload" data-bind="click: function(){selectTab('upload')}, css: {'tab_selected': selectedTab() == 'upload'}">Upload</div>
    	<!-- ko if: myImages().length -->
    	<div class="tab" data-bind="click: function(){selectTab('my_images')}, css: {'tab_selected': selectedTab() == 'my_images'}">My Images</div>
    	<!-- /ko -->
    	<!-- /ko -->
    	<div class="tab" data-bind="click: function(){selectTab('library')}, css: {'tab_selected': selectedTab() == 'library'}">Library</div>
    </div>
    <div class="uploadmodal-close icon-close" data-bind="click: toggleImageUpload"></div>
    <!-- ko if: isAuthenticated -->
    <div data-bind="visible: (selectedTab() == 'upload')">
	    <div class="uploadmodal-preview" data-bind="click: clickUpload, event:{ dragover: dragOver, drop: drop}, style: { backgroundImage: 'url(\'' + (src() ? src() : '/canvas/images/upload.png') + '\')' }, css: {'uploadmodal-preview_populated': src()}"></div>
	    <input type="file" id="image-upload" accept="image/*" data-bind="file: {data: fileData, allowed: ['image/jpg', 'image/png', 'image/jpeg', 'image/svg+xml']}" style="opacity: 0;">

	    <div class="uploadmodal-info">
	    	<h2>Here are some tips for making your images look great in print</h2>
	    	<ul>
	    		<li>Choose high quality images</li>
	    		<li>We accept .JPG, .JPEG and .PNG files</li>
	    		<li>Minimum file size 150 KB</li>
	    		<li>Maximum file size 10 MB</li>
	    		<li>You can crop and resize after upload</li>
	    	</ul>
	    	<div class="uploadmodal-info-footer">
	    		Any images uploaded will automatically be added to My Images
	    	</div>
	    </div>
	    <!-- ko if: src() -->
	    <a class="button" data-bind="click: confirm">Use this image</a>
	    <!-- /ko -->
    </div>

    <div data-bind="visible: (selectedTab() == 'my_images')">
		<div class="library my-library" data-bind="css: {'library_loading': myImagesLoading}">
	    	<!-- ko foreach: myImages() -->
	    	<div class="library-image" data-bind="click: $parent.selectMyImage, css: {'library-image_selected': $parent.myImage() == $data}">
	    		<div class="library-image-inner" data-bind="style: {backgroundImage: 'url(' + SmallSrc + '&' + $parent.getRandomInt() + ')'}"></div>
	    		<div class="library-image-delete" data-bind="click: $parent.setDeleteImage, clickBubble: false">
	    			<span class="icon-delete"></span>
	    		</div>
	    	</div>
	    	<!-- /ko -->
	    </div>
	    <!-- ko if: myImage() -->
	    <a class="button" data-bind="click: confirm">Use this image</a>
	    <!-- /ko -->
    </div>
    <!-- /ko -->

    <div data-bind="visible: (selectedTab() == 'library')">
    	<div class="dropdown-row">
            <dropdown-component params="{options: tags, selected: tag, anchorClass: 'tools-dropdown', placeholder: 'Select Category', autohide: true}"></dropdown-component>
        </div>
    	<div class="library" data-bind="css: {'library_loading': libraryLoading}">
	    	<!-- ko foreach: libraryImagesFiltered() -->
	    	<div class="library-image" data-bind="click: $parent.selectLibraryImage, css: {'library-image_selected': $parent.libraryImage() == $data}">
	    		<div class="library-image-inner" data-bind="style: {backgroundImage: 'url(' + SmallSrc + ')'}"></div>
	    	</div>
	    	<!-- /ko -->
	    </div>
	    <!-- ko if: libraryImage() -->
	    <a class="button" data-bind="click: confirm">Use this image</a>
	    <!-- /ko -->
    </div>
</div>

<!-- ko if: deleteImage -->
<!-- ko with: deleteImage -->
<div class="modal-bg" data-bind="click: $parent.clearDeleteImage">
</div>
<div class="modal-container">
	<div class="modal">
		<div class="modal-text">Are you sure you want to delete this image?</div>
		<div class="modal-buttons">
		<a class="button button_grey" data-bind="click: $parent.clearDeleteImage">Keep</a>
		<a class="button" data-bind="click: function() {$parent.removeMyImage($data); $parent.clearDeleteImage()}">Delete</a>
		</div>
	</div>
</div>
<!-- /ko -->
<!-- /ko -->